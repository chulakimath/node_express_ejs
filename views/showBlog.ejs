<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <%- include("./layouts/head") %>
</head>

<body class="">
    <%- include("./layouts/nav") %>
        <% if(locals.error){%>
            <div class="alert alert-danger mt-2 mx-2" role="alert">
                <%= locals.error %>
            </div>
            <% }else{ %>
                <div class="card">
                    <div class="" style="padding: 2% 10%;">
                        <div class="card-body bg-dark-subtle d-flex justify-content-center"
                            style="border-radius: 10px;">
                            <img style="width: 90%;" src="/uploads/<%=locals.data.coverImageUrl%>" alt="">
                        </div>
                    </div>
                </div>

                <div class="container">




                    <div class="p-4">
                        <h5>
                            <%=locals.data.title %>
                        </h5>
                    </div>

                    <div class="py-2 px-4" style="width: 100%;">
                        <pre style="text-align: justify;">
                        <%=locals.data.body %>
                    </pre>
                    </div>
                </div>
                <div style="border-radius: 15px; box-shadow: #000 0px 0px 4px;"
                    class="m-4 p-2 d-flex gap-3 align-items-center alert alert-info ">
                    <div style="width: 100px;height: 100px;">
                        <img height="100%" width="100%" style="border-radius: 50%;"
                            src="/<%=locals.data.createdBy.profileImageUrl %>" alt="...">
                    </div>
                    <div class="text-dark">
                        <h6>
                            Author - <%=locals.data.createdBy.fullname %>
                                <br>
                                Email - <%=locals.data.createdBy. email %>
                        </h6>
                    </div>
                </div>
                <hr>
                <div class="container mt-3">
                    <h2>Comments</h2>
                    <%if(locals.user &&locals.user._id){%>
                        <form method="post" action="/blog/comment/<%=locals.data._id%>">
                            <div class="mb-3">
                                <label for="comment" class="form-label">Comment</label>
                                <textarea class="form-control" placeholder="Enter our Comment" id="comment"
                                    name="comment"></textarea>
                            </div>
                            <div class="mb-3">
                                <input class="btn btn-primary" type="submit" value="Submit">
                            </div>
                        </form>

                        <%}else{%>

                            <a href="/user/signin" style="text-decoration: none;">
                                <div class="alert alert-warning">
                                    <h6>Please login to Comment</h6>
                                </div>
                            </a>
                            <%}%>


                                <!-- comments -->
                                <% if(locals.dataComments){ %>
                                    
                                    <%locals.dataComments.forEach(element=>{ %>
                                        <div class="border border-dark mb-2 border-dark 
                                        <%if(element.commentedBy._id==locals.user._id){%>
                                            border-primary-subtle
                                            <%}%>
                                        " style="border-radius: 5px;">
                                            <div class="container mt-2 d-flex gap-4 align-items-center">
                                                <div style="" class="bg-primary">
                                                    <img height="35" width="35"
                                                        src="/<%=element.commentedBy. profileImageUrl%>" alt="...">
                                                </div>
                                                <div>
                                                    <p>
                                                        <%=element.commentedBy. fullname%>
                                                    </p>
                                                </div>
                                            </div>
                                            <p class="" style="margin-left:60px">
                                                <%=element.comment%>
                                            </p>
                                        </div>
                                        <%})%>
                                            <%}%>
                </div>
                <%} %>
                    <%- include("./layouts/scripts") %>

</body>

</html>